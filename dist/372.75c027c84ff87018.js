"use strict";(self.webpackChunkfree_version=self.webpackChunkfree_version||[]).push([[372],{1372:(y,p,n)=>{n.r(p),n.d(p,{PedidosComponent:()=>m});var _=n(6814),r=n(95),l=n(627),g=n(8645),e=n(9468),u=n(1492),c=n(870),h=n(2098);function f(s,a){if(1&s&&(e.TgZ(0,"option",23),e._uU(1),e.qZA()),2&s){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}let m=(()=>{class s{constructor(t,o,d){this.notify=t,this.api=o,this.router=d,this.dtOptions={},this.dtTrigger=new g.x,this.pedido={id:0,info:"",company_id:"",company_name:"",user_id:"",user_name:"",estado:"",estado2:"",pedido_id:0},this.message="",this.data=[],this.data1=[],this.users=[],this.orden={info:"",company_id:"",user_id:"",estado:0,pedido_id:0}}someClickHandler(t){this.message=t.id,this.pedido=t,this.pedido.pedido_id=t.id,console.log(this.pedido),this.orden.company_id=this.pedido.company_id,this.orden.info=this.pedido.info,this.orden.pedido_id=this.pedido.id}ngAfterViewInit(){this.dtTrigger.next(this.dtOptions)}ngOnDestroy(){this.dtTrigger.unsubscribe()}rerender(){let t=this;this.dtElement.dtInstance.then(o=>{o.destroy(),t.dtOptions.data=this.data,this.dtTrigger.next(t.dtOptions),console.log(t.dtOptions)}),console.log(this.data)}ngOnInit(){this.dtOptions={data:this.data,columns:[{title:"",data:null,defaultContent:'<input type="checkbox">'},{title:"ID",data:"id"},{title:"Informaci\xf3n",data:"info"},{title:"Empresa",data:"company_name"},{title:"Usuario",data:"user_name"},{title:"Estado",data:"estado2"}],rowCallback:(o,d,i)=>{const C=this;return $("td",o).off("click"),$("td",o).on("click",()=>{C.someClickHandler(d)}),o}};let t=this;this.api.getpedidos().subscribe({next(o){o.reverse(),console.log(o),t.data=o;for(let d=0;d<t.data.length;d++)0==t.data[d].estado&&(t.data[d].estado2="Creado"),1==t.data[d].estado&&(t.data[d].estado2="Asignado"),2==t.data[d].estado&&(t.data[d].estado2="Ejecutando"),3==t.data[d].estado&&(t.data[d].estado2="Terminado");t.rerender()},error(o){console.log(o),t.notify.notifyError(o.error)}}),this.api.getusers().subscribe({next(o){console.log(o),t.users=o,t.rerender()},error(o){console.log(o),t.notify.notifyError(o.error)}})}crear(){let t=this;""==this.pedido.info?this.notify.notifyError("Complete los datos"):(console.log(this.pedido),this.api.createpedidos(this.pedido).subscribe({next(o){console.log(o),t.notify.notifySuccess("Pedido creado con \xe9xito!"),t.reset()},error(o){console.log(o),t.notify.notifyError(o.error)}}))}crear_order(){let t=this;""==this.pedido.info?this.notify.notifyError("Complete los datos"):(console.log(this.pedido),this.api.createorders(this.pedido).subscribe({next(o){console.log(o),t.notify.notifySuccess("Orden creada con \xe9xito!"),t.updatepedido(o[0])},error(o){console.log(o),t.notify.notifyError(o.error)}}))}updatepedido(t){let o=this;this.api.updatepedidos(this.pedido.id,{estado:1,orden_id:t}).subscribe({next(i){console.log(i),o.notify.notifySuccess("Pedido actualizado con \xe9xito!"),o.reset()},error(i){console.log(i),o.notify.notifyError(i.error)}})}ver(){this.router.navigate(["/home"])}reset(){this.pedido.id=0,this.pedido.info="",this.pedido.company_id="",this.pedido.user_id="",this.pedido.estado="",this.pedido.pedido_id=0,this.pedido.company_name="",this.pedido.user_name="",this.pedido.estado2="",this.orden.info="",this.orden.company_id="",this.orden.user_id="",this.orden.estado=0,this.orden.pedido_id=0,this.add()}add(){this.data=[]}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(u.s),e.Y36(c.s),e.Y36(h.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-pedidos"]],viewQuery:function(t,o){if(1&t&&e.Gf(l.G,5),2&t){let d;e.iGM(d=e.CRH())&&(o.dtElement=d.first)}},standalone:!0,features:[e.jDz],decls:53,vars:11,consts:[[1,"row"],[1,"row","justify-content-center"],[1,"col-xl-8","col-md-8"],[1,"card"],[1,"card-body"],[1,"text-danger"],["datatable","",1,"row-border","hover",3,"dtOptions","dtTrigger"],[1,"col-xl-4","col-md-4"],[1,"auth-header"],[1,"text-primary","mt-5"],[1,"text-secondary"],[1,"fs-4","mt-2"],[1,"form-floating","mb-3"],["type","text","id","Empresa","value","Empresa ...",1,"form-control",3,"ngModel","ngModelChange"],["for","Empresa"],["type","text","id","info","value","Info ...",1,"form-control",3,"ngModel","ngModelChange"],["for","info"],[1,"form-control",3,"ngModel","ngModelChange"],["value","default"],[3,"value",4,"ngFor","ngForOf"],["type","text","id","Info2","value","Descripci\xf3n de la orden...",1,"form-control",3,"ngModel","ngModelChange"],[1,"d-grid","mt-4"],["type","button",1,"btn","btn-secondary",3,"click"],[3,"value"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",0)(6,"p",5),e._uU(7,"Has seleccionado: "),e.TgZ(8,"strong"),e._uU(9),e.qZA()(),e._UZ(10,"table",6),e.qZA()()()(),e.TgZ(11,"div",7)(12,"div",3)(13,"div",4)(14,"div",0)(15,"div",8)(16,"h4",9),e._uU(17),e.qZA(),e.TgZ(18,"h2",10)(19,"b"),e._uU(20,"Informaci\xf3n del pedido"),e.qZA()(),e.TgZ(21,"p",11),e._uU(22,"Resumen del pedido"),e.qZA()(),e.TgZ(23,"div",12)(24,"input",13),e.NdJ("ngModelChange",function(i){return o.pedido.info=i}),e.qZA(),e.TgZ(25,"label",14),e._uU(26,"Descripci\xf3n"),e.qZA()(),e.TgZ(27,"div",12)(28,"input",15),e.NdJ("ngModelChange",function(i){return o.pedido.company_name=i}),e.qZA(),e.TgZ(29,"label",16),e._uU(30,"Empresa"),e.qZA()(),e.TgZ(31,"div",12)(32,"input",15),e.NdJ("ngModelChange",function(i){return o.pedido.user_name=i}),e.qZA(),e.TgZ(33,"label",16),e._uU(34,"Creado por el usuario"),e.qZA()(),e.TgZ(35,"h2",10)(36,"b"),e._uU(37),e.qZA()(),e._UZ(38,"hr"),e.TgZ(39,"div",12)(40,"select",17),e.NdJ("ngModelChange",function(i){return o.orden.user_id=i}),e.TgZ(41,"option",18),e._uU(42,"----"),e.qZA(),e.YNc(43,f,2,2,"option",19),e.qZA(),e.TgZ(44,"label",16),e._uU(45,"Asignar orden"),e.qZA()(),e.TgZ(46,"div",12)(47,"input",20),e.NdJ("ngModelChange",function(i){return o.orden.info=i}),e.qZA(),e.TgZ(48,"label",16),e._uU(49,"Descripci\xf3n de la orden"),e.qZA()(),e.TgZ(50,"div",21)(51,"button",22),e.NdJ("click",function(){return o.crear_order()}),e._uU(52,"Crear orden"),e.qZA()()()()()()()()),2&t&&(e.xp6(9),e.Oqu(o.message),e.xp6(1),e.Q6J("dtOptions",o.dtOptions)("dtTrigger",o.dtTrigger),e.xp6(7),e.hij("Estado: ",o.pedido.estado2,""),e.xp6(7),e.Q6J("ngModel",o.pedido.info),e.xp6(4),e.Q6J("ngModel",o.pedido.company_name),e.xp6(4),e.Q6J("ngModel",o.pedido.user_name),e.xp6(5),e.hij("Crear una orden a este pedido, ID: ",o.orden.pedido_id," "),e.xp6(3),e.Q6J("ngModel",o.orden.user_id),e.xp6(3),e.Q6J("ngForOf",o.users),e.xp6(4),e.Q6J("ngModel",o.orden.info))},dependencies:[l.T,l.G,r.u5,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.On,_.ez,_.sg],styles:[".auth-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{text-align:right}"]}),s})()}}]);